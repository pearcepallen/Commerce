{% extends "auctions/layout.html" %}           

{% block title%} {{item.name}} {% endblock %}
{% block body %}
    <h2>{{item.name}}</h2>

    {% if messages %}       <!-- error/success message(needs styling)-->
    <ul class="messages">
        {% for message in messages %}
        <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    
    <div id="item">

        {% if item.active == True %}
            {% if user.is_authenticated and curr_user == item.user and item.active == True %}
                <div>
                <a href="{% url 'close' item.id %}" > <button type="button">Close Listing </button> </a>
                </div>
            {% endif %}
        {% else %}
            <h3>Closed</h3>
            {% if curr_user == bid.user %}
                <h3>You are the winner!!!!</h3>
            {% endif %}
        {% endif %}
        
        <div>
            <div>
                <img src="{{item.image}}" alt="Image of item">
            </div>

            <div>
                <div>{{ item.desc }} </div>
                <div>
                {% if bid %}
                    Current Bid: ${{bid.bid}} 
                {% else %}
                    Starting Bid: ${{item.start_bid}} 
                {% endif %}
                </div>
            </div>
        </div>

        {% if user.is_authenticated %}
        <a href = "{% url 'watchlist' item.id %}"><button type="button">{{watch}}</button></a>

        <form action="{% url 'bid' item.id %}" method="POST">
            {% csrf_token %}
            {{form}}
            <input type="submit" value="Place Bid">
        </form>      
        {% endif %}

        <h4>Details</h4>
        <ul>
            <li> Listed by: {{item.user.username}} </li>
            <li> Category: {{item.category.category}} </li>
        </ul>

        {% if user.is_authenticated %}
        <form action="{% url 'comment' item.id %}" method="POST">
            {% csrf_token %}
            {{comment_form}}
            <input type="submit" value="Post Comment">
        </form>  
        {% endif %}

        <h4>Comments</h4>
        {% for comment in comments %}
            <div>
                <p>{{comment.comment}}</p>
            </div>
        {% endfor %}

    </div>
{% endblock %}